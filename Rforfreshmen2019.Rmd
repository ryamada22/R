---
title: "Rで行列演算とグラフ"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Rのインストール

https://cran.r-project.org/


## Rで行列演算

### ベクトル

数値を１つ以上並べたもの。

```{r}
v1 <- c(1,3) # 長さ2のベクトル
print(v1)
```

```{r}
v1.yoko <- v1
v1.yoko
```

縦に１行、横に２行とみなすこともできる。
```{r}
v1.yoko. <- matrix(v1,nrow=1)
v1.yoko.
```

この場合は、１行ｘ２列の行列とも言える。

縦に並べることもできる。

２列ｘ１行の行列として作って表示すると、そのように見える。

```{r}
v1.tate. <- matrix(v1,ncol=1)
v1.tate.
```

### 正方行列による座標変換

```{r}
M1 <- matrix(c(1,2,3,4),nrow=2,ncol=2)
M1
```

正方行列縦ベクトルに左から掛けると、縦ベクトルの値が変化する。

```{r}
new.v1.tate. <- M1 %*% v1.tate.
new.v1.tate.
```

この行列M1について、少し調べてみる。

点(1,0)はどこに動くか？

$$
M1 \begin{pmatrix}1 \\ 0 \end{pmatrix}
$$
とすると、点(1,0)はどこに動くか？

```{r}
v2 <- matrix(c(1,0),ncol=1)
v2
M1 %*% v2
```

では、点(0,1)はどこに動くか？

```{r}
v3 <- matrix(c(0,1),ncol=1)
v3
M1 %*% v3
```

行列M1を左から掛けると、点(1,0)は、M1の第１ベクトルに、

点(0,1)は、M1の第２ベクトルに変換される。

### 行列は掛け算もできる

```{r}
M2 <- matrix(c(2,-1,3,1),nrow=2,ncol=2)
M2
```
行列M2は、点(0,1)をどこに移し、点(1,0)をどこに移すだろうか？

やってみる。

```{r}
M2 %*% v2
M2 %*% v3
```

点(1,0)をM1で点(1,2)に動かし、
点(1,2)をM2で動かすには

```{r}
new.v2 <- M2 %*% v2
new.v2
M2 %*% new.v2
```
とすればよい。

```{r}
M2 %*% (M1 %*% v2)
```
としてもよい。

```{r}
(M2 %*% M1) %*% v2
```
としてもよい。

```{r}
M21 <- M2 %*% M1
M21 %*% v2
```
としてもよい。


* 問い
  + では、v2 + v3 = (1,1)は、行列M1によってどこに移されるか？

## Rでグラフ

グラフとは、点の集合と、点をつなぐ線(辺)の集合のペアのこと。

```{r}
install.packages("igraph") # グラフを扱う関数を集めたパッケージを取り込む
library(igraph) # igraphパッケージの関数をサクサクと使うための宣言文
```

4点でできたグラフを作ってみる。

頂点 1-2, 2-3, 3-4, 2-4に辺があるグラフを作る。

```{r}
edge.list <- rbind(c(1,2),c(2,3),c(3,4),c(2,4))
edge.list
```

すべての辺の両端点情報があれば、グラフは作れる。

```{r}
g <- graph.edgelist(edge.list,directed=FALSE)
plot(g,vertex.size=50)
```

### グラフの隣接行列

```{r}
ad.matrix <- get.adjacency(g)
ad.matrix
```

1と"."でできている。
ちょっと見づらいので"."を0に代える。

```{r}
A <- as.matrix(ad.matrix)
A
```

4x4正方行列がグラフgから取り出された。

行列の(i,j)成分が1のとき、頂点i-頂点jの間に辺があり、
そうでないとき、辺がないようにできている。

#### 隣接行列の解釈とべき乗

隣接行列Aの(i,j)成分は、「頂点iから頂点jへと、『１つの辺を辿ってたどり着く通り道の場合の数」を表している、とも言えます。

```{r}
A2 <- A %*% A
A2
```

これは$A^2$です。

隣接行列Aの2乗の(i,j)成分は、「頂点iから頂点jへと、『辺をたどること２回でたどり着く通り道の場合の数」を表している、と言えるといいます。

それぞれの成分について、通り道の場合を列挙してみましょう。

$A^3$はどうなるでしょうか？

